| Название | Категория |        Сложность         |
| :------: | :-------: | :----------------------: |
| Лазанья  |  Реверс   | $${\color{green}Легко}$$ |

[Файлы](give) для задания

## Анализ программы

Запихнем программу в Detect It Easy

![](images/binary_analyze.png)

В качестве упаковщика указан PyInstaller, что говорит о том, что программа написана на языке Python. Для того, чтобы получить код программы, нам надо распаковать и декомпилировать программу. Для такой операции существуют два инструмента:

- [pyinstxtractor](https://github.com/extremecoders-re/pyinstxtractor) для распаковки бинарника
- [uncompyle6](https://pypi.org/project/uncompyle6/) для декомпиляции pyc файла

![](images/unpacking_binary.png)

![](images/decompiling_pyc.png)

Перенесем вывод uncompyle6 в файл lasagna.py

## Реверс

После декомпиляции получили следующий код

![](decompiled_code.png)

Видим, что есть две переменные t и ll:

- t - зашифрованный флаг
- ll - баннер
  Две функции c и s:
- c - шифр Цезаря
- e - функция многоступенчатого шифрования
  Программа нас просит ввести флаг, потом ввод проходит через следующую цепочку шифрования:

```mermaid
graph LR;
    Цезарь-->Base64;
    Base64-->XOR;
    XOR-->AES-CBC-128
```

Цезарь шифрует только буквы латинского алфавита.

## Расшифровка флага

Для дешифрации флага надо сделать всю эту цепочку в обратном порядке:

```mermaid
graph RL;
    AES-CBC-128-->XOR;
    XOR-->Base64;
    Base64-->Цезарь;
```

[Решение](solve.py)

## Флаг

```
CODEBY{L@sAgna_aND_2ncr3pt1on}
```
